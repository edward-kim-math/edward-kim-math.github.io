---
layout: default
title: Sage for Linear Algebra
---
<h1>{{ page.title }}</h1>

<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
<script>sagecell.makeSagecell({"inputLocation": ".sage"});</script>

<p><a href="http://www.sagemath.org/">Sage</a> is a free and open source computer algebra system (CAS).
	It is a viable alternative to Maple, Mathematica, and Magma.
	The coding style for Sage is based on the well-known language Python, whereas Maple and Mathematica are proprietary languages.
Sage can be used for a lot of typical linear algebra computations.</p>

<p>Any of the scripts on this page can be run "live" on the web by clicking "Evaluate."
Moreover, you can modify a script and click "Evaluate" again, and your code will run!</p>

<h2>Expanding and factoring expressions</h2>
Sage can expand the expression \((x-1)^8\) or factor the expression \(x^3+4x^2+8x+32\). Note that the multiplication asterisk is REQUIRED by sage between the \(4\) and \(x^2\), as well as between the \(8\) and the \(x\).
<div class="sage">
<script type="text/x-sage">
powerofbinomial = (x-1)^8
print(powerofbinomial.expand())

polynomial = x^3 + 4*x^2 + 8*x + 32
print(polynomial.factor())
</script>
</div>

<h2>Vector geometry</h2>
Given vectors \(u = (3,4,5)\) and \(v = (1,0,-3)\),
Sage will compute the dot product \(u \cdot v\),
the cross product \(u \times v\),
and the linear combination \(10u + 3v\).
<div class="sage">
<script type="text/x-sage">
u = vector([3,4,5])
v = vector([1,0,-3])

print("The dot product of u and v is") # text you wish to print is in double-quotes
print(u.dot_product(v))
print("The cross product of u and v is")
print(u.cross_product(v))
print("The following vector is a linear combination of u and v:")
print(10*u+3*v)
</script>
</div>


<h2>Transpose of a matrix</h2>
This example specifies a \(2 \times 3\) matrix \(B\), then computes the transpose of \(B\).
<div class="sage">
<script type="text/x-sage">
B = matrix([[5,6,7],[0,9,8]])

# Set up how LaTeX code should look for the format of a matrix
latex.matrix_delimiters(left='(', right=')') # using either parens or square brackets is typical for a matrix
latex.matrix_column_alignment('c') # can use l, c, or r for column alignment

print("The matrix B is")
print(B)
print("The LaTeX version of B is")
print(latex(B))
print("The transpose of B is")
print(B.transpose())
print("The LaTeX version of the transpose of B is")
print(latex(B.transpose()))
</script>
</div>


<h2>Solving a system of linear equations</h2>
Sage can solve a system of linear equations such as \(y+3x=-2\) and \(x-2y = 5\).
Of course, Sage can also solve the same system by producing the rref of the appropriate augmented matrix.
<div class="sage">
<script type="text/x-sage">
var('y') # declare y to be a variable. By default, x is always a variable.
print(solve([y + 3*x == -2, x - 2*y == 5], x,y))

A = matrix([[3,1,-2],[1,-2,5]])
print(A.rref())

# Set up how LaTeX code should look for the format of a matrix
latex.matrix_delimiters(left='(', right=')') # using either parens or square brackets is typical for a matrix
latex.matrix_column_alignment('c') # can use l, c, or r for column alignment

print("The original matrix A is ")
print(A)
print("and having this formatted for LaTeX, A is")
print(latex(A))
print("The rref of A is ")
print(A.rref())
print("and having this formatted for LaTeX, the rref is")
print(latex(A.rref()))
</script>
</div>
If you do not modify the input, as the final part of the output, you will see
<pre>
\left(\begin{array}{ccc}
1 & 0 & \frac{1}{7} \\
0 & 1 & -\frac{17}{7}
\end{array}\right)
</pre>
If you wish to have a vertical bar before the last column, manually insert the vertical bar in {ccc}. That is, once pasting the output into your LaTeX project, modify the code by insertion of one character, producing
<pre>
\left(\begin{array}{cc|c}
1 & 0 & \frac{1}{7} \\
0 & 1 & -\frac{17}{7}
\end{array}\right)
</pre>




<h2>Matrix algebra/operations: linear combination of matrices, including the identity matrix</h2>
This example defines \(3 \times 3\) matrices \(A\) and \(B\).
Then is asked to compute the linear combination \(2A+3B+4000I\), where \(I\) is the \(3 \times 3\) identity matrix.
<div class="sage">
<script type="text/x-sage">
A = matrix([[1,1,2],[2,3,3],[4,0,-5]])
B = matrix([[5,6,7],[0,9,8],[10,11,7/3]])

# Set up how LaTeX code should look for the format of a matrix
latex.matrix_delimiters(left='(', right=')') # using either parens or square brackets is typical for a matrix
latex.matrix_column_alignment('c') # can use l, c, or r for column alignment

print("The matrix A is")
print(A)
print("The LaTeX version of A is")
print(latex(A))

print("The matrix B is")
print(B)
print("The LaTeX version of B is")
print(latex(B))

print("2A+3B+4000I is a linear combination of A, B, and I, and it is")
print(2*A + 3*B + 4000*identity_matrix(3))
print("Formatted for LaTeX, this is")
print(latex(2*A + 3*B + 4000*identity_matrix(3)))
</script>
</div>

<h2>Matrix multiplication</h2>
This example defines a \(3 \times 4\) matrix \(C\) and a \(4 \times 2\) matrix \(D\) and computes the product \(CD\).
<div class="sage">
<script type="text/x-sage">
C = matrix([[-3, 0, -99, 10], [3, -1, 0, -20], [0, -1, -1, 1]])
D = matrix([[1, -2], [-3, -1], [0, -1], [1, -2]])

print("C is")
print(C)
print("D is")
print(D)
print("CD is")
print(C*D)
</script>
</div>



<h2>Computations on a square matrix</h2>
This example defines a \(4 \times 4\) matrix \(A\).
We have the system compute the determinant and the trace of \(A\), outputting both of these on screen.
We also have Sage compute the characteristic polynomial of \(A\).
<div class="sage">
<script type="text/x-sage">
A = matrix([[42, 45, -189, -276], [40, 48, -174, -296], [8, 9, -39, -52], [8, 9, -33, -58]])

print("The matrix A is")
print(A)

print("The determinant of A is")
print(det(A))

print("The trace of A is")
print(trace(A))

# Set up how LaTeX code should look for the format of a matrix
latex.matrix_delimiters(left='(', right=')') # using either parens or square brackets is typical for a matrix
latex.matrix_column_alignment('c') # can use l, c, or r for column alignment

print("For insertion in LaTeX, the matrix A is")
print(latex(A))

print("Building the characteristic polynomial by hand, we have")
print(det(A-x*identity_matrix(4)))

print("Sage also has a built-in charateristic polynomial feature, which gives:")
print(A.characteristic_polynomial())

print("A^5 is")
print(A^5)
print("and formatted for LaTeX, A^5 is")
print(latex(A^5))
</script>
</div>


<h2>Singular Value Decomposition</h2>
Sage can compute <a href="http://www.cfm.brown.edu/people/dobrush/am34//sage/svd.html">SVD</a> for a matrix.
<div class="sage">
<script type="text/x-sage">
A=matrix(RDF,[[4,2,5],[0,16,0],[0,14,9]]) # RDF stands for "real double field"
print "The eigenvalues of A are", A.eigenvalues()
U, Sigma, V = A.SVD()
print("U is the matrix")
print(U)
print("Sigma is the matrix")
print(Sigma)
print("V is the matrix")
print(V)
</script>
</div>


<h2>LU Decomposition</h2>
Sage can compute <a href="http://doc.sagemath.org/html/en/reference/matrices/sage/matrix/matrix2.html">LU</a> for a matrix.
<div class="sage">
<script type="text/x-sage">
A = matrix(QQ, [[1, -1,  0,  2,  4,  7, -1],
                [2, -1,  0,  6,  4,  8, -2],
                [2,  0,  1,  4,  2,  6,  0],
                [1,  0, -1,  8, -1, -1, -3],
                [1,  1,  2, -2, -1,  1,  3]])
P, L, U = A.LU(pivot='nonzero')
print("P is the matrix")
print(P)
print("L is the matrix")
print(L)
print("U is the matrix")
print(U)
</script>
</div>


<h2>Discrete Markov Chains</h2>
Sage can find the steady state distribution for a <a href="https://vknight.org/OR_Methods/Markov_Chains/Markov_Chains_Sage_Sheet_Solutions.pdf">discrete Markov chain</a>.
<div class="sage">
<script type="text/x-sage">
A=matrix([[.8,.2,0],[.1,.7,.2],[.1,.3,.6]])

var("pi1,pi2,pi3")

solve([A[0,0]*pi1+A[1,0]*pi2+A[2,0]*pi3==pi1,
A[0,1]*pi1+A[1,1]*pi2+A[2,1]*pi3==pi2,
A[0,2]*pi1+A[1,2]*pi2+A[2,2]*pi3==pi3,
pi1+pi2+pi3==1],[pi1,pi2,pi3])
</script>
</div>



<h2>Continuous Markov Chains</h2>
Sage can find the steady state probabilities for a <a href="https://vknight.org/OR_Methods/Markov_Chains/Markov_Chains_Sage_Sheet_Solutions.pdf">continuous Markov chain</a>.
<div class="sage">
<script type="text/x-sage">
Q=matrix([[-3,3,0,0],[4,-7,3,0],[0,4,-7,3],[0,0,4,-4]])

var("pi1,pi2,pi3,pi4")

solve([Q[0,0]*pi1+Q[1,0]*pi2+Q[2,0]*pi3+Q[3,0]*pi4==0,
Q[0,1]*pi1+Q[1,1]*pi2+Q[2,1]*pi3+Q[3,1]*pi4==0,
Q[0,2]*pi1+Q[1,2]*pi2+Q[2,2]*pi3+Q[3,2]*pi4==0,
Q[0,3]*pi1+Q[1,3]*pi2+Q[2,3]*pi3+Q[3,3]*pi4==0,
pi1+pi2+pi3+pi4==1],[pi1,pi2,pi3,pi4])
</script>
</div>



<h2>Markov Chain visualization</h2>
Sage can visualize the states of <a href="https://gist.github.com/drvinceknight/7b479fd1cd0868e4590c">Markov chains</a>.
<div class="sage">
<script type="text/x-sage">
@interact
def _(A=matrix(RDF,3,3,[8,2,0,1,7,2,1,3,6])/10,x_init=("$\pi^{(0)}$",vector([.2,.5,.3]))):
    x_init = vector(x_init)
    data = [x_init * (A^i) for i in range(20)]
    pi = zip(*data)
    p = line(enumerate(pi[0]),color='red',legend_label='$\pi_1$',thickness=3)
    p += line(enumerate(pi[1]),color='blue',legend_label='$\pi_2$',thickness=3)
    p += line(enumerate(pi[2]),color='green',legend_label='$\pi_3$',thickness=3)
    p.ymax(1)
    show(p)
</script>
</div>


